{% extends 'base/base.html' %}
{% block title %}
Messager
{% endblock %}
{% block content %}
<h1 class="fs-1 text-center">Messager</h1>
<div class="d-flex justify-content-center">
    <div class="shadow-lg col-12 col-sm-9 rounded mt-3">
        {% if users %}
        {% for user in users %}
        <a href="{% url 'app:message' slug=user.slug  %}#last" class="border-bottom d-flex col-12 flex-wrap  {% if user.count > 0  %}  bg-green-500 {% endif %}  align-items-center text-decoration-none p-3" style="cursor: pointer;">
            <div class="d-flex align-items-center col-2  ">
                <img src="{{user.img}}" class="profile-img me-2" alt="User Profile" />
            </div>  
            <div class=" d-flex flex-column col-3">
                    <p class="">@{{user.username}}</p> 
                    {% if user.obj.message_by_user %}
                    {% if user.obj.is_seen %}
                    <p class="text-secondary"><i class="fa-solid text-primary fa-check"></i><i style="margin-left: -10px;" class="fa-solid text-primary fa-check"></i> {{user.obj.msg | truncatewords:3}}</p> 
                    {% else %}
                    <p class="text-secondary"><i class="fa-solid fa-check"></i><i style="margin-left: -10px;" class="fa-solid fa-check"></i> {{user.obj.msg | truncatewords:3}}</p>
                    {% endif %}
                    {% else  %}
                    <div class="d-flex ">
                        <p class="text-secondary">{{user.obj.msg | truncatewords:3}}</p>  
                    </div>
                    {% endif %}
                </div>

            <div class="col-6 d-flex ">
                <p class=" text-muted "><span class="fs-5"></span><span>{{user.obj.last_message}}</span></p>
            </div>
            {% if user.count > 0  %}
            <div class="col-1 d-flex justify-content-end">
                <p style="width: 30px ; height: 30px;" class=" d-flex align-items-center justify-content-center rounded-circle text-white bg-success">{{user.count}}</p>
            </div>
            {% endif  %}
        </a>   
        {% endfor %}
        {% else %}
        <p class="fs-1 text-secondary fw-bold">No Messages</p>
        {% endif %}
     
    </div>
</div>
{% endblock %}